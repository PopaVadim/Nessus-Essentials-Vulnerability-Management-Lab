<h1>Nessus Essentials Vulnerability Management Lab</h1>

<h2>Description</h2>
This is a walkthrough of how I created A Virtual Machine environment using VMWare running Windows 10. I did this project to gain experience with Nessus Essentials and learn how to scan for vulnerabilities and remediate them. This project will showcase two of the main steps in the Vulnerability Management Lifecycle. I will be using Nessus Essentials to scan local VMs hosted on VMWare Workstation in order run credentialed scans to discover vulnerabilities, remediate some of the vulnerabilities, then perform a rescan to verify remediation.
<br />

<h2>Utilities Used</h2>

- <b>Nessus Essentials</b> 
- <b>CMD</b>

<h2>Environments Used </h2>

- <b>VMWare Fusion Pro</b>
- <b>Windows 10</b> (21H2)

<h2 align="center">Program walk-through</h2>
<br/><br/>

<b>We start our Lab with downloading and installing our Vulnerability Managment Software, Nessus Essentials.</b> <br/>
</p>

<img width="1016" alt="Nessus_Instal2" src="https://user-images.githubusercontent.com/117952272/209855357-66090959-0865-4f77-8de1-50cf6b607599.png">


<b>After the installation is finished we log in with the newly created Nessus Account.</b> <br/><br/>
<img width="1016" height="900" alt="Nessus_Instal4" src="https://user-images.githubusercontent.com/117952272/209855523-f89c4ff5-32b1-461d-9a8f-b971246288ff.png">

<b>Now the next step will be creating a new Windows Virtual Machine for Vulnerability Scanning inside of VMWare Fusion. 

<img width="1016" alt="New Virtual Machine" src="https://user-images.githubusercontent.com/117952272/209863792-765b2aa4-619d-49fb-8951-7444d22e7a0f.png">

<br/><br/>

<b>Next we will go to the Processors & Memory tab for our newly created Virtual Machine inside of VMWare settings. Here we will readjust the hardware settings for the Processor, RAM ,and Network Adapter.</b>

 
<img width="1016" alt="VM_Settings" src="https://user-images.githubusercontent.com/117952272/209864397-c3e86425-6140-425e-885c-91d4e14b7f75.png">

<img width="1016" alt="VM_Network_Settings" src="https://user-images.githubusercontent.com/117952272/209864407-31e09ee7-5a14-4701-a56b-bf5071eb8fdc.png">

<br/><br/>

<b>Now it is time to attach our ISO and go ahead and install our Windows Virtual Machine.<b/>

 
<img width="1016" alt="Screen Shot 2022-12-28 at 1 21 29 PM" src="https://user-images.githubusercontent.com/117952272/209865067-e34fb295-4a7a-4eb4-b5bf-fca624f4a2d2.png">

<img width="1016" alt="Win_instal2" src="https://user-images.githubusercontent.com/117952272/209870215-a5c2d01c-c9bd-4b39-824d-c4a6ab5487a7.png">

<img width="1016" alt="Win_instal_ finished" src="https://user-images.githubusercontent.com/117952272/209871488-dc2750c8-5748-4ef0-9fd1-c3ee791352ca.png">

<br/><br/>

<b>We gonna open the Command Prompt and run the ipconfig command to find out the IP address on our newly created Windwos Virtual Machine. The IP address will be needed for our Vulnerability scans on Nessus. Below you can see that the IP address of our VM is 192.168.1.197<b/>  

<img width="1016" alt="Ipconfig VM" src="https://user-images.githubusercontent.com/117952272/209872753-26556796-15ff-44aa-8660-0d07e2596991.png">

<br/><br/>
 
<b>I tried to ping the Virtual Machine from the Host Machine to check if we can communicate with the VM. We do this since if we can't ping the machine then Nessus won't be able to runt the scan either. Below we can see that the pings are timming out which means the Host machine can't enstablish a connection with the VM at the moment.</b> <br/>
<b>The Host Machine couldn't communicate with the VM because it has the Firewall active which blocks all the connection attemps. This is a good thing but not for the purpose of our Vulnerability Scan Lab. Therefore, we will have to disable the firewall. This is acceptable only for this specific task only in this envoirment.<b/>

<img width="1016" alt="Ping VM" src="https://user-images.githubusercontent.com/117952272/209874626-21958190-53f4-4c6a-b6c1-5d4533d3d4ef.png">





<br/><br/>

<b> In order for me to be able to communicate with the VM I will have to access Windows Defender Firewall Proprieties on our Virtual Machine.</b> 

<br/>

<img width="1016" alt="VM Firewall" src="https://user-images.githubusercontent.com/117952272/209877339-6b2a16eb-1224-4637-a306-a393afc40571.png">

<br/><br/>

<b>Then we go to Domain, Private ,and Public Profiles Firewall and change the state status to off of all three then save the settings. After we should be able to communicate with the VM.</b>

<br/>
 
<img width="1016" alt="VM Firewall2" src="https://user-images.githubusercontent.com/117952272/209877139-c8fca3c7-42de-4f34-8f76-48a41112686f.png">

<br/><br/>

<b>Since the Firewall is disabled, I tried to ping from the Host Machine the Virtual Machine again and this time it was successful.<b/>

<br/>

<img width="1016" alt="Successful VM Ping" src="https://user-images.githubusercontent.com/117952272/209880858-515af15d-0fd3-4720-93f0-e0aa9dec31a8.png">

<br/><br/>

<b>Now is time to create our first Nessus scan. We will choose the Basic Network Scan, Give it a name ,and give it the target that Nessus will have to scan. In our case is our Virtual machine and it has the IP address 192.168.1.197
 See all the steps below</b>

<br/>
 
https://user-images.githubusercontent.com/117952272/209882610-91d8dc52-e174-4e54-bbf0-01e8be3e31a2.mp4

<br/><br/>

<b>Below we can see the results of our Scan. We have 32 results, 17 Vulnerabilities, 1 medium severity vulnerability and 31 results listed as info.</b>

<br/>

https://user-images.githubusercontent.com/117952272/209883654-3a6c063e-5329-459d-9157-ba62d5f73db8.mp4

<br/><br/>

<b>Target Credential Status By Authentication Procotol Info was triggered because we did not provide credetials for this scan.<b/><br/>

<img width="1016" alt="INFO" src="https://user-images.githubusercontent.com/117952272/209883823-ff6400bb-9f0e-43a6-af38-3eadc1b47715.png">

<br/><br/>

<b>Our next step is to configure our VM so it will accept authenticated scans and give Nessus the credetials to run the scan for us.<br/>
<b>We will rescan the VM and we will have an opportunity to compare the results. We will go to services.msc and start the process of allowing remote registry. This will allow Nessus to connect to the VM registry and a more comprehensive scan for vulnerabilities like insecure connections or depricated cipher suites. We will set up our VM according to Nessus recommandatios for a credentialed scan.<b/><br/>

<br/>

<b>We will go first to Services and find Remote Registry and change startup type to Automatic press Apply then Start and save the settings.<b/>
<br/>

<img width="1016" alt="Remote_Registry" src="https://user-images.githubusercontent.com/117952272/210010833-637d8d46-9f10-4a38-91b4-68d6331debd8.png">
<br/><br/>

<b>Next step will be disabaling the User Account Control since this VM is not on a domain so we have to work around it for the purpose of our Lab. This is a step you should never do in an actual organization or production envoirment.<b/>
<br/><br/>

<img width="1016" alt="User_Account_Control_Settings" src="https://user-images.githubusercontent.com/117952272/210011164-c7a3f452-72c1-454c-8a22-17bb9f5b476f.png">
<br/><br/>

<b>We will open registry and we will have to add a key to allow Nessus to connect to our Virtual Machine. After we accessed Registry Editor the path will be Computer\HKEY_LOCAL MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System.<b/>
<b>According to Nessus directions we will have to create a new DWORD32 Value<b/>
<br/><br/>

<img width="1016" alt="Registry" src="https://user-images.githubusercontent.com/117952272/210012017-84c9343d-7fb7-46b1-b6a2-b068de53aafe.png">
<br/><br/>

<b>We will call it "LocalAccountTokenFilterPolicy" and give it a value of 1 and restart our Virtual Machine so all the changes take charge.<b/>
<br/><br/> 

<img width="1016" alt="Registry2" src="https://user-images.githubusercontent.com/117952272/210012315-353b382c-2013-456b-bbf7-ad32a8a6daa2.png">
<br/><br/>

<b>Registry is configured and our Virtual Machine is all set up and ready for the Credentialed Scan. We will go ahead and add the Credentials to the Nessus Scan we created earlier. This will allow Nessus to use the username and password where it is required in the VM registry. See all the steps below<b/>
<br/><br/> 


https://user-images.githubusercontent.com/117952272/210019080-07873418-129c-482e-91c7-059086e22447.mp4

<br/><br/> 

<b>After the Credentialed Scan is finished, we see that it found a lot more vulnerabilities since it was able to scan a lot deeper into our VM because it was authorized to do with the credentials we provided.<b/> 
<b>The Credentialed Scan found , 39 Vulnerabilities, 18 listed as Critical, 11 High, 163 info. 
See a walk through all the vulnerabilities found.<b/>
<br/><br/> 



https://user-images.githubusercontent.com/117952272/210019456-5cfef479-6b77-43ce-a26b-2e33ae20413c.mp4

<br/><br/> 

<b>To test Nessus capabilities we will install an old version of FIrefox and run a third scan and see the results.<b/>
<br/><br/> 


https://user-images.githubusercontent.com/117952272/210021564-40dc373d-a244-4c63-9656-b7b611989287.mp4

<br/><br/> 

<b>Below we can see what outdated software does and how many vulnerabilities in introduces. We received 42 Vulnerabilities, 91 Critical, 77 High, 17 Medium, 169 info.<b/>
<b>When we look through Critical Alerts most of them are cause by Firefox.<b/>
 
<br/><br/> 
  
https://user-images.githubusercontent.com/117952272/210021583-225f7cfd-c26b-49f5-bb66-af1416c77084.mp4

<br/><br/> 

<b>Below we can see a comparisson between scan to see the diffrences of alerts and vulnerabilities.<b/>
<br/><br/> 


<img width="1016" alt="Scan_Comparasion" src="https://user-images.githubusercontent.com/117952272/210022176-7c265fd8-96a4-44e5-9a56-8225eec3d8f3.png">


